# 微信公众号文章下载器 - GUI版本

一个跨平台的微信公众号文章批量下载工具，支持图形界面操作。

## 功能特性

- 🚀 **Selenium扫码登录**：基于真实浏览器的自动扫码登录，更稳定可靠
- 🔐 **自动登录**：保存登录凭据，支持一键自动登录
- 🔍 **公众号搜索**：搜索并选择目标公众号
- 📄 **文章列表**：分页浏览公众号文章列表
- 💾 **多格式导出**：支持Markdown和HTML格式导出
- 🖼️ **图片本地化**：自动下载并本地化文章中的图片
- 🎯 **选择性导出**：支持单篇导出和批量导出
- 🌐 **跨平台支持**：支持Windows、macOS、Linux
- 🛡️ **反爬虫抵抗**：模拟真实用户行为，避免检测

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 启动程序

```bash
python wechat_gui.py
```

### 2. 登录配置

程序提供三种登录配置方式：

#### 方式一：Selenium扫码登录（强烈推荐）
1. 选择"扫码登录（推荐）"
2. 点击"启动扫码登录"按钮
3. 系统自动打开Chrome浏览器
4. 在浏览器中用微信扫描登录二维码
5. 在微信中确认登录
6. 程序自动检测登录完成并保存凭据
7. 下次可直接使用"自动登录"功能

**优势：**
- 无需手动配置Cookie和Token
- 模拟真实用户行为，更稳定
- 自动保存登录凭据
- 反爬虫抵抗力强

#### 方式二：自动登录（需先扫码登录保存凭据）
1. 选择"自动登录（已保存凭据）"
2. 程序自动检查保存的登录凭据状态
3. 点击"使用保存的凭据登录"即可
4. 无需重复扫码

#### 方式三：手动配置
1. 在浏览器登录微信公众号平台：https://mp.weixin.qq.com/
2. 获取登录后的Cookie和Token
3. 在"手动配置"区域填入Cookie和Token
4. 点击"保存配置"

### 3. 搜索公众号

1. 切换到"搜索公众号"选项卡
2. 在搜索框中输入公众号名称
3. 点击"搜索"按钮
4. 在搜索结果中双击选择目标公众号

### 4. 浏览文章

1. 选择公众号后自动跳转到"文章列表"选项卡
2. 浏览当前页面的文章列表
3. 使用"上一页"/"下一页"按钮浏览更多文章

### 5. 导出文章

#### 导出设置
1. 切换到"导出设置"选项卡
2. 选择导出格式（Markdown或HTML）
3. 设置输出目录
4. 配置导出选项

#### 导出操作
- **导出选中文章**：在文章列表中选中要导出的文章，然后点击"导出选中文章"
- **导出所有文章**：直接点击"导出所有文章"按钮导出该公众号的所有文章

## 目录结构

导出的文件按以下结构组织：

```
articles/
├── 公众号名称/
│   ├── images/          # 文章中的图片
│   ├── 文章1.md
│   ├── 文章2.html
│   └── ...
└── 其他公众号/
    └── ...
```

## 配置说明

### Cookie获取方法
1. 在Chrome浏览器中登录微信公众号平台
2. 按F12打开开发者工具
3. 切换到Network标签
4. 刷新页面
5. 找到任意请求，在Request Headers中找到Cookie字段
6. 复制完整的Cookie值

### Token获取方法
1. 登录后在Network标签中查找包含token的请求
2. 从URL参数中提取token值

## 注意事项

1. **登录安全**：请妥善保管Cookie和Token信息
2. **请求频率**：程序已内置延迟机制，避免请求过快被封禁
3. **网络环境**：确保网络连接稳定，部分网络环境可能需要代理
4. **法律合规**：请遵守相关法律法规，仅用于学习和个人使用

## 故障排除

### 登录失败
- 检查Cookie和Token是否正确
- 确认网络连接正常
- 尝试重新获取登录凭证

### 搜索无结果
- 确认已正确登录
- 检查搜索关键词是否准确
- 确认公众号是否存在于搜索结果中

### 导出失败
- 检查输出目录是否有写入权限
- 确认网络连接稳定
- 查看错误信息进行针对性排查

## 技术支持

如遇到问题，请检查：
1. Python版本（推荐Python 3.8+）
2. 依赖包是否正确安装
3. 网络连接状态
4. 日志输出信息

## 更新日志

### v2.0.0 - Selenium登录版本
- ✨ 新增基于Selenium的扫码登录功能
- ✨ 新增自动登录功能，支持保存的登录凭据
- 🛡️ 大幅提升反爬虫抵抗力
- 🚀 简化用户操作流程，一键扫码登录
- 🗑️ 移除不稳定的账号密码登录方式
- 📦 更新依赖包，添加Selenium和WebDriver支持

### v1.0.0
- 初始版本发布
- 支持基本的登录、搜索、导出功能
- 图形界面完成